# 烛龙绘影 v1.17.0 发布说明

## 🚀 重大更新：文生图功能全面优化

### 新增功能

#### 🆕 Z-Image Turbo 模型
- **极速生图**: 新增轻量级快速生成模型
- **高效响应**: 使用同步接口，生成速度更快
- **灵活分辨率**: 支持512²到2048²像素范围
- **PNG格式**: 高质量图片输出

#### 🔥 万相2.6 批量生成
- **批量支持**: 支持1-4张图片批量生成
- **单次调用**: 使用高效的批量API，减少请求次数
- **完整功能**: 支持反向提示词、随机种子等所有参数

### 性能优化

#### ⚡ API调用效率提升
- **万相2.6**: 4张图片从4次调用优化为1次调用（75%减少）
- **万相2.5/2.2**: 同样实现批量优化，大幅提升生成速度
- **智能策略**: 根据模型能力自动选择最优调用方式

#### 🎯 模型能力精准适配
- **Z-Image**: 固定1张，不支持反向提示词
- **万相系列**: 支持1-4张批量，完整功能
- **通义千问**: 修正为单张生成，避免API错误

### 用户体验改进

#### 🎨 动态UI调整
- **智能界面**: 根据选择的模型自动调整可用选项
- **清晰提示**: 每个模型的限制和能力一目了然
- **防错设计**: 避免用户设置不支持的参数

#### 🛠️ 智能错误处理
- **详细分类**: 7种常见错误类型，每种都有针对性解决方案
- **友好提示**: 将技术错误转换为用户易懂的描述
- **实用建议**: 每个错误都提供3-4条具体解决步骤
- **双重反馈**: 状态标签+详细弹窗，信息层次清晰

## 📊 模型能力对比

| 模型 | 批量支持 | 反向提示词 | 接口类型 | 特点 |
|------|----------|------------|----------|------|
| Z-Image Turbo | ❌ (1张) | ❌ | 同步 | 极速生成 |
| 万相2.6 | ✅ (1-4张) | ✅ | 同步 | 最新功能 |
| 万相2.5 | ✅ (1-4张) | ✅ | 异步 | 灵活分辨率 |
| 万相2.2 | ✅ (1-4张) | ✅ | 异步 | 稳定可靠 |
| 通义千问 | ❌ (1张) | ✅ | 异步 | 预设分辨率 |

## 🔧 技术改进

### API调用优化
- 实现了同步和异步接口的统一批量处理
- 支持部分成功的批量结果处理
- 智能文件命名（批量图片自动编号）

### 错误处理系统
- 结构化错误信息格式
- 智能错误类型识别
- 支持Fluent风格和标准消息框

### 代码质量
- 完善的调试日志系统
- 向后兼容性保证
- 模块化的错误处理逻辑

## 🎯 使用建议

### 选择合适的模型
- **快速预览**: 使用Z-Image Turbo
- **高质量生成**: 使用万相2.6
- **批量生产**: 使用万相2.5/2.2
- **特定尺寸**: 使用通义千问

### 优化生成效率
- 批量生成时优先选择万相系列模型
- 合理设置随机种子实现可重复生成
- 利用提示词智能改写提升效果

## 🐛 修复问题

- 修复万相2.6批量生成的响应解析问题
- 修复通义千问模型的参数限制问题
- 修复JSON模块导入错误
- 修复批量任务计数显示问题
- 修复UI组件初始化顺序问题

## 📝 开发者说明

本次更新重点优化了文生图功能的性能和用户体验，通过精准的模型能力适配和智能的错误处理，让用户能够更高效地使用AI生图功能。

---

**发布日期**: 2025年12月23日  
**版本号**: v1.17.0  
**兼容性**: 向后兼容，建议所有用户升级